{% extends "base.html" %}

{% block title %}{{ record[config.list_columns[0]] if config.list_columns else config.display_name }} - View - Leaknote Admin{% endblock %}

{% block extra_head %}
<style>
    .markdown-content {
        line-height: 1.6;
    }
    .markdown-content h1, .markdown-content h2, .markdown-content h3 {
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .markdown-content code {
        background: #f4f4f4;
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-size: 0.9em;
    }
    .markdown-content pre {
        background: #f4f4f4;
        padding: 1em;
        border-radius: 5px;
        overflow-x: auto;
    }
    .markdown-content pre code {
        background: none;
        padding: 0;
    }
    .markdown-content blockquote {
        border-left: 4px solid #ddd;
        padding-left: 1em;
        color: #666;
        margin: 1em 0;
    }
    .markdown-content ul, .markdown-content ol {
        padding-left: 2em;
    }
    .markdown-content table {
        border-collapse: collapse;
        width: 100%;
        margin: 1em 0;
    }
    .markdown-content th, .markdown-content td {
        border: 1px solid #ddd;
        padding: 0.5em;
    }
    .markdown-content th {
        background: #f4f4f4;
    }
</style>
{% endblock %}

{% block content %}
<div class="record-view">
    <div class="page-header">
        <h1>{{ record.title or record.name or config.display_name }}</h1>
        <div class="page-actions">
            <a href="/table/{{ table_name }}" class="btn">Back to List</a>
            <a href="/table/{{ table_name }}/{{ record.id }}/edit" class="btn btn-primary">Edit</a>
        </div>
    </div>

    <div class="record-details">
        {% for field in config.fields %}
        <div class="field-group">
            <h3>{{ field.label }}</h3>
            {% if field.type == "markdown" and rendered[field.name] %}
            <div class="markdown-content">
                {{ rendered[field.name] | safe }}
            </div>
            {% elif record[field.name] %}
            {% if field.type == "tags" %}
            <div class="tags">
                {% for tag in record[field.name] %}
                <span class="tag">{{ tag }}</span>
                {% endfor %}
            </div>
            {% else %}
            <p>{{ record[field.name] }}</p>
            {% endif %}
            {% else %}
            <p class="text-muted">None</p>
            {% endif %}
        </div>
        {% endfor %}

        <div class="field-group">
            <h3>Metadata</h3>
            <p><strong>Created:</strong> {{ record.created_at }}</p>
            {% if record.updated_at %}
            <p><strong>Updated:</strong> {{ record.updated_at }}</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
